<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Movable Type Pro 5.13-en" />
<link rel="stylesheet" href="/pub/styles.css" type="text/css" />
<link rel="start" href="/pub/" title="Home" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/pub/atom.xml" />
<script type="text/javascript" src="/pub/mt.js"></script>
<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="/pub/2002/05/14/mod_perl.html">
<dc:title>The Perl You Need To Know - Part 3</dc:title>
<dc:description> Introduction This article is the third in our series talking about the essential Perl basics that you should know before starting to program for mod_perl. Variables Globally, Lexically Scoped and Fully Qualified You will hear a lot about namespaces,...</dc:description>
<dc:creator>Stas Bekman</dc:creator>
<dc:date>2002-05-15T00:00:00-08:00</dc:date>
<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/3.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/3.0/">
</License>
</rdf:RDF>
-->

<script type="text/javascript">

 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-50555-22']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type =
   'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
   'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(ga, s);
 })();

</script>
<script type='text/javascript' src='http://partner.googleadservices.com/gampad/google_service.js'></script>
<script type='text/javascript'>
GS_googleAddAdSenseService("ca-pub-4136420132070439");
GS_googleEnableAllServices();
</script>
<script type='text/javascript'>
GA_googleAddSlot("ca-pub-4136420132070439", "Perl_728x90");
</script>
<script type='text/javascript'>GA_googleFetchAds();</script>
    
    <link rel="prev bookmark" href="/pub/2002/05/07/optree.html" title="Where Wizards Fear To Tread" />
    <link rel="next bookmark" href="/pub/2002/05/22/mod_perl-isp.html" title="Finding a mod_perl ISP... or Becoming One" />
    
    
    <title>The Perl You Need To Know - Part 3 - Perl.com</title>
</head>
<body id="perl-com" class="mt-entry-archive layout-wt">
    <div id="container">
        <div id="container-inner">


            <div id="header">
    <div id="header-inner">
        <div id="header-content">
        <span id="top_advert"> 
<!-- Put any landscape advert in here -->
<!-- Perl_728x90 -->
<script type='text/javascript'>
GA_googleFillSlot("Perl_728x90");
</script>
        </span> 



            <div id="header-name"><a href="/pub/" accesskey="1">Perl.com</a></div>
            <div id="header-description">news and views of the Perl programming language</div>




        </div>
    </div>
</div>



            <div id="content">
                <div id="content-inner">


                    <div id="alpha">
                        <div id="alpha-inner">


                            <div id="entry-1300" class="entry-asset asset hentry">
                                <div class="asset-header">
                                    <h1 id="page-title" class="asset-name entry-title">The Perl You Need To Know - Part 3</h1>
                                    <div class="asset-meta">
                                        <span class="byline">

                                            By <span class="vcard author">Stas Bekman</span> on <abbr class="published" title="2002-05-15T00:00:00-08:00">May 15, 2002 12:00 AM</abbr>

                                        </span>


                                    </div>
                                </div>
                                <div class="asset-content entry-content">

                                    <div class="asset-body">
                                        
<!-- sidebar begins -->
<!-- no -->
<!--sidebar ends -->
<h3><a name="introduction">Introduction</a></h3>
<p>This article is the third in our series talking about the essential
Perl basics that you should know before starting to program for
<code>mod_perl</code>.</p>


<h3><a name="variables_globally,_lexically_scoped_and_fully_qualified">Variables Globally, Lexically Scoped and Fully Qualified</a></h3>

<p>You will hear a lot about namespaces, symbol tables and lexical
scoping in Perl discussions, but little of it will make any sense
without a few key facts:</p>

<h4><a name="symbols,_symbol_tables_and_packages;_typeglobs">Symbols, Symbol Tables and Packages; Typeglobs</a></h4>
<p>There are two important types of symbols: package global and lexical.
We will talk about lexical symbols later; for now, we will talk only
about package global symbols, which we will refer to as
<em>global symbols</em>.</p>
<p>The names of pieces of your code (subroutine names) and the names of
your global variables are symbols.  Global symbols reside in one
symbol table or another.  The code itself and the data do not; the
symbols are the names of pointers that point (indirectly) to the
memory areas that contain the code and data. (Note for C/C++
programmers: We use the term `pointer' in a general sense of one piece
of data referring to another piece of data, and not in the specific sense as
used in C or C++.)</p>
<p>There is one symbol table for each package, (which is why <em>global
symbols</em> are really <em>package global symbols</em>).</p>
<p>You are always working in one package or another.</p>

<csperl file="grab" domain="on" record="b/832" template="b/article_sidebar2.view">

<p>Just as in C, where the first function you write must be called <code>main()</code>,
the first statement of your first Perl script is in package <code>main::</code>,
which is the default package.  Unless you say otherwise by using the
<code>package</code> statement, your symbols are all in package <code>main::</code>. You
should be aware that files and packages are <em>not
related</em>. You can have any number of packages in a single file; and a
single package can be in one file or spread among many files. However,
it is common to have a single package in a single file. To
declare a package you write:</p>
<pre><code>
    package mypackagename;</code></pre>
<p>From the following line you are in package <code>mypackagename</code> and any
symbols you declare reside in that package. When you create a symbol
(variable, subroutine, etc.) Perl uses the name of the package in which
you are currently working as a prefix to create the fully qualified
name of the symbol.</p>
<p>When you create a symbol, Perl creates a symbol table entry for that
symbol in the current package's symbol table (by default
<code>main::</code>). Each symbol table entry is called a <em>typeglob</em>. Each
typeglob can hold information on a scalar, an array, a hash, a
subroutine (code), a filehandle, a directory handle and a format, each
of which all have the same name.  So you see now that there are two
indirections for a global variable: the symbol (the thing's name)
points to its typeglob, and the entry in the typeglob for the 
thing's type (scalar,
array, etc.)  points to the data. If we had a scalar and an array with
the same name, then their name would point to the same typeglob, but for
each type of data the typeglob points to somewhere different. Hence,
the scalar's data and the array's data are completely separate and
independent, they just happen to have the same name.</p>
<p>Most of the time, only one part of a typeglob is used (yes, it's a bit
wasteful).  By now, you know that you distinguish between them by
using what the authors of the Camel book call a <em>funny character</em>. So
if we have a scalar called `<code>line</code>,' then we would refer to it in code as
<code>$line</code>, and if we had an array of the same name, that would be
written, <code>@line</code>. Both would point to the same typeglob (which would
be called <code>*line</code>), but because of the <em>funny character</em>, (also known
as <em>decoration</em>) Perl won't confuse the two. Of course, we might
confuse ourselves, so some programmers don't ever use the same name
for more than one type of variable.</p>
<p>Every global symbol is in some package's symbol table. To refer to a
global symbol we could write the <em>fully qualified</em> name,
e.g. <code>$main::line</code>. If we are in the same package as the symbol, then we
can omit the package name, e.g.  <code>$line</code> (unless you use the <code>strict</code>
pragma and then you will have to predeclare the variable using the
<code>vars</code> pragma). We can also omit the package name if we have imported
the symbol into our current package's namespace. If we want to refer
to a symbol that is in another package and which we haven't imported, then
we must use the fully qualified name, e.g. <code>$otherpkg::box</code>.</p>
<p>Most of the time, you do not need to use the fully qualified symbol
name, because most of the time you will refer to package variables from
within the package.  This is like C++ class variables.  You can
work entirely within package <code>main::</code> and never even know you are
using a package, nor that the symbols have package names.  In a way,
this is a pity, because you may fail to learn about packages and they
are extremely useful.</p>
<p>The exception is when you <em>import</em> the variable from another package.
This creates an alias for the variable in the <em>current</em> package, so
that you can access it without using the fully qualified name.</p>
<p>While global variables are useful for sharing data and are necessary
in some contexts, it is usually wiser to minimize their use and use
<em>lexical variables</em>, discussed next, instead.</p>
<p>Note that when you create a variable, the low-level business of
allocating memory to store the information is handled automatically by
Perl.  The intepreter keeps track of the chunks of memory to which the
pointers are pointing and takes care of undefining variables. When all
references to a variable have ceased to exist, then the Perl garbage
collector is free to take back the memory used ready for
recycling. However, Perl almost never returns back memory it has
already used to the operating system during the lifetime of the
process.</p>

<h3><a name="lexical_variables_and_symbols">Lexical Variables and Symbols</a></h3>
<p>The symbols for lexical variables (i.e. those declared using the
keyword <code>my</code>) are the only symbols that do <em>not</em> live in a symbol
table.  Because of this, they are not available from outside the block
in which they are declared.  There is no typeglob associated with a
lexical variable and a lexical variable can refer only to a scalar, an
array or a hash.</p>
<p>If you need access to the data from outside the package, then you can
return it from a subroutine, or you can create a global variable
(i.e. one that has a package prefix) that points or refers to it, and
return that.  The reference must be global so that you can
refer to it by a fully qualified name. But just like in C, try to avoid
having global variables. Using OO methods generally solves this
problem by providing methods to get and set the desired value within
the object that can be lexically scoped inside the package and passed
by reference.</p>
<p>The phrase ``lexical variable'' is a bit of a misnomer, as we are really
talking about ``lexical symbols.''  The data can be referenced by a
global symbol, too, and in such cases when the lexical symbol goes out
of scope the data will still be accessible through the global symbol.
This is perfectly legitimate and cannot be compared to the terrible
mistake of taking a pointer to an automatic C variable and returning
it from a function -- when the pointer is dereferenced there will be a
segmentation fault.  (Note for C/C++ programmers: having a function
return a pointer to an auto variable is a disaster in C or C++; the
Perl equivalent, returning a reference to a lexical variable created
in a function is normal and useful.)</p>
<table cellspacing="12" cellpadding="0" border="0" align="right" width="200"><tr><td>
<center><img src="/images/pixel-hub.gif" width="200" height="2" hspace="0" vspace="10" border="0" alt=" " /><br />
<center><a href="http://conferences.oreilly.com/oscon/"><img src="/images/os2002/oscon-sidebar.gif" alt="O'Reilly Open Source Convention -- July 22-26, San Diego, CA." width="143" height="78" border="0" /></a></center>
<p class="smalllist"><strong>From the Frontiers of Research to the Heart of the Enterprise</strong></p>
</center>
<p class="secondary"><a href="http://conferences.oreillynet.com/cs/os2002/view/e_sess/3032">mod_perl 2.0, the Next Generation</a>
Stas Bekman will provide an overview of what's new in mod_perl 2.0 and what else is planned for the future in his talk at the upcoming <a href="http://conferences.oreillynet.com/os2002/">O'Reilly Open Source Convention</a>, this July 22-26, in San Diego.</p>
<center><img src="/images/pixel-hub.gif" width="200" height="2" hspace="0" vspace="0" border="0" alt=" " /></center>
</td></tr></table>

<ul>
<li>
<code>my()</code> vs. <code>use vars</code>:
<p>With use vars(), you are making an entry in the symbol table, and you
are telling the compiler that you are going to be referencing that
entry without an explicit package name.</p>
<p>With my(), NO ENTRY IS PUT IN THE SYMBOL TABLE.  The compiler figures
out <i>at compile time</i> which <code>my()</code> variables (i.e. lexical variables)
are the same as each other, and once you hit execute time you cannot
look up those variables in the symbol table.</p>
</li>
<li>
<code>my()</code> vs. <code>local()</code>:
<p><code>local()</code> creates a temporal-limited package-based scalar, array, hash,
or glob -- that's to say, when the scope of definition is exited at runtime, the
previous value (if any) is restored.  References to such a variable
are <b>also</b> global ... only the value changes.  (Aside: that is what
causes variable suicide. :)</p>
<p><code>my()</code> creates a lexically limited nonpackage-based scalar, array, or
hash -- when the scope of definition is exited at compile-time, the
variable ceases to be accessible.  Any references to such a variable
at runtime turn into unique anonymous variables on each scope exit.</p>
</li></ul>












<h3><a name="use(),_require(),_do(),_%inc_and_@inc_explained">use(), require(), do(), %INC and @INC Explained</a></h3>
<p>
</p>
<h4><a name="the_@inc_array">The @INC Array</a></h4>
<p><code>@INC</code> is a special Perl variable that is the equivalent to the
shell's <code>PATH</code> variable. Whereas <code>PATH</code> contains a list of
directories to search for executables, <code>@INC</code> contains a list of
directories from which Perl modules and libraries can be loaded.</p>
<p>When you <code>use()</code>, <code>require()</code> or <code>do()</code> a filename or a module, Perl gets a
list of directories from the <code>@INC</code> variable and searches them for
the file it was requested to load.  If the file that you want to load
is not located in one of the listed directories, then you have to tell Perl
where to find the file.  You can either provide a path relative to one
of the directories in <code>@INC</code>, or you can provide the full path to the
file.</p>


<h4><a name="the_%inc_hash">The %INC Hash</a></h4>
<p><code>%INC</code> is another special Perl variable that is used to cache the
names of the files and the modules that were successfully loaded and
compiled by <code>use()</code>, <code>require()</code> or <code>do()</code> statements. Before attempting to
load a file or a module with <code>use()</code> or require(), Perl checks whether
it's already in the <code>%INC</code> hash. If it's there, then the loading and
therefore the compilation are not performed at all. Otherwise, the file
is loaded into memory and an attempt is made to compile it. <code>do()</code> does
unconditional loading -- no lookup in the <code>%INC</code> hash is made.</p>
<p>If the file is successfully loaded and compiled, then a new key-value pair
is added to <code>%INC</code>. The key is the name of the file or module as it
was passed to the one of the three functions we have just mentioned.
If it was found in any of the <code>@INC</code> directories except <code>&quot;.&quot;</code>,
then the value is the full path to it in the file system.</p>
<p>The following examples will make it easier to understand the logic.</p>
<p>First, let's see what are the contents of <code>@INC</code> on my system:</p>
<pre><code>
  % perl -e 'print join &quot;\n&quot;, @INC'
  /usr/lib/perl5/5.00503/i386-linux
  /usr/lib/perl5/5.00503
  /usr/lib/perl5/site_perl/5.005/i386-linux
  /usr/lib/perl5/site_perl/5.005
  .</code></pre>
<p>Notice that <code>.</code> (current directory) is the last directory in the list.</p>
<p>Now let's load the module <code>strict.pm</code> and see the contents of <code>%INC</code>:</p>
<pre><code>
  % perl -e 'use strict; print map {&quot;$_ =&gt; $INC{$_}\n&quot;} keys %INC'
  
  strict.pm =&gt; /usr/lib/perl5/5.00503/strict.pm</code></pre>
<p>Since <code>strict.pm</code> was found in <em>/usr/lib/perl5/5.00503/</em> directory
and <em>/usr/lib/perl5/5.00503/</em> is a part of <code>@INC</code>, <code>%INC</code> includes
the full path as the value for the key <code>strict.pm</code>.</p>
<p>Now let's create the simplest module in <code>/tmp/test.pm</code>:</p>
<pre><code>
  test.pm
  -------
  1;</code></pre>
<p>It does nothing, but returns a true value when loaded. Now let's load
it in different ways:</p>
<pre><code>
  % cd /tmp
  % perl -e 'use test; print map {&quot;$_ =&gt; $INC{$_}\n&quot;} keys %INC'
  
  test.pm =&gt; test.pm</code></pre>
<p>Since the file was found relative to <code>.</code> (the current directory), the
relative path is inserted as the value. If we alter <code>@INC</code> by adding
<em>/tmp</em> to the end:</p>
<pre><code>
  % cd /tmp
  % perl -e 'BEGIN{push @INC, &quot;/tmp&quot;} use test; \
  print map {&quot;$_ =&gt; $INC{$_}\n&quot;} keys %INC'
  
  test.pm =&gt; test.pm</code></pre>
<p>Here we still get the relative path, since the module was found first
relative to <code>&quot;.&quot;</code>. The directory <em>/tmp</em> was placed after <code>.</code> in the
list. If we execute the same code from a different directory, then the
<code>&quot;.&quot;</code> directory won't match,</p>
<pre><code>
  % cd /
  % perl -e 'BEGIN{push @INC, &quot;/tmp&quot;} use test; \
  print map {&quot;$_ =&gt; $INC{$_}\n&quot;} keys %INC'
  
  test.pm =&gt; /tmp/test.pm</code></pre>
<p>so we get the full path. We can also prepend the path with <code>unshift()</code>,
so it will be used for matching before <code>&quot;.&quot;</code> and therefore we will
get the full path as well:</p>
<pre><code>
  % cd /tmp
  % perl -e 'BEGIN{unshift @INC, &quot;/tmp&quot;} use test; \
  print map {&quot;$_ =&gt; $INC{$_}\n&quot;} keys %INC'
  
  test.pm =&gt; /tmp/test.pm</code></pre>
<p>The code:</p>
<pre><code>
  BEGIN{unshift @INC, &quot;/tmp&quot;}</code></pre>
<p>can be replaced with the more elegant:</p>
<pre><code>
  use lib &quot;/tmp&quot;;</code></pre>
<p>Which is almost equivalent to our <code>BEGIN</code> block and is the
recommended approach.</p>
<p>These approaches to modifying <code>@INC</code> can be labor intensive, since if
you want to move the script around in the file-system, then you have to
modify the path. This can be painful, for example, when you move your
scripts from development to a production server.</p>
<p>There is a module called <code>FindBin</code> that solves this problem in the
plain Perl world, but, unfortunately, it won't work under mod_perl,
since it's a module, and as any module, it's loaded only once. So the
first script using it will have all the settings correct, but the rest
of the scripts will not if they're in a different directory from the
first.</p>
<p>For the sake of completeness, I'll present this module anyway.</p>
<p>If you use this module, then you don't need to write a hard-coded path. The
following snippet does all the work for you (the file is
<em>/tmp/load.pl</em>):</p>
<pre><code>
  load.pl
  -------
  #!/usr/bin/perl
  
  use FindBin ();
  use lib &quot;$FindBin::Bin&quot;;
  use test;
  print &quot;test.pm =&gt; $INC{'test.pm'}\n&quot;;</code></pre>
<p>In the above example, <code>$FindBin::Bin</code> is equal to <em>/tmp</em>. If we move
the script somewhere else... e.g. <em>/tmp/x</em> in the code above
<code>$FindBin::Bin</code> equals <em>/home/x</em>.</p>
<pre><code>
  % /tmp/load.pl
  
  test.pm =&gt; /tmp/test.pm</code></pre>
<p>This is just like <code>use lib</code> except that no hard-coded path is
required.</p>
<p>You can use this workaround to make it work under mod_perl.</p>
<pre><code>
  do 'FindBin.pm';
  unshift @INC, &quot;$FindBin::Bin&quot;;
  require test;
  #maybe test::import( ... ) here if need to import stuff</code></pre>
<p>This has a slight overhead, because it will load from disk and
recompile the <code>FindBin</code> module on each request. So it may not be
worth it.</p>













<h4><a name="modules,_libraries_and_program_files">Modules, Libraries and Program Files</a></h4>
<p>Before we proceed, let's define what we mean by <em>module</em>, <em>library</em>
and <em>program file</em>.</p>
<ul>
<li><strong><a name="item_libraries">Libraries</a></strong>
</li>
These are files that contain Perl subroutines and other code.
<p>When these are used to break up a large program into manageable chunks,
they don't generally include a package declaration; when they are used
as subroutine libraries, they often do have a package declaration.</p>
<p>Their last statement returns true, a simple <code>1;</code> statement ensures
that.</p>
<p>They can be named in any way desired, but generally their extension is
<em>.pl</em>.</p>
<p>Examples:</p>
<pre><code>
  config.pl
  ----------
  # No package so defaults to main::
  $dir = &quot;/home/httpd/cgi-bin&quot;;
  $cgi = &quot;/cgi-bin&quot;;
  1;</code></pre>
<pre><code>
  mysubs.pl
  ----------
  # No package so defaults to main::
  sub print_header{
    print &quot;Content-type: text/plain\r\n\r\n&quot;;
  }
  1;</code></pre>
<pre><code>
  web.pl
  ------------
  package web ;
  # Call like this: web::print_with_class('loud',&quot;Don't shout!&quot;);
  sub print_with_class{
    my( $class, $text ) = @_ ;
    print qq{&lt;span class=&quot;$class&quot;&gt;$text&lt;/span&gt;};
  }
  1;</code></pre>

<li><strong><a name="item_modules">Modules</a></strong><br />
</li>
A file that contains Perl subroutines and other code.
<p>It generally declares a package name at the beginning.</p>
<p>Modules are generally used either as function libraries (which <em>.pl</em>
files are still but less commonly used for), or as object libraries
where a module is used to define a class and its methods.</p>
<p>Its last statement returns true.</p>
<p>The naming convention requires it to have a <em>.pm</em> extension.</p>
<p>Example:</p>
<pre><code>
  MyModule.pm
  -----------
  package My::Module;
  $My::Module::VERSION = 0.01;
  
  sub new{ return bless {}, shift;}
  END { print &quot;Quitting\n&quot;}
  1;</code></pre>

<li><strong><a name="item_program_files">Program Files</a></strong><br />
</li>
<p>Many Perl programs exist as a single file. Under Linux and other
Unix-like operating systems, the file often has no suffix since the
operating system can determine that it is a Perl script from the first
line (shebang line) or if it's Apache that executes the code, there is
a variety of ways to tell how and when the file should be executed.
Under Windows, a suffix is normally used, for example <code>.pl</code> or
<code>.plx</code>.
<p>The program file will normally <code>require()</code> any libraries and <code>use()</code>
any modules it requires for execution.</p>
<p>It will contain Perl code but won't usually have any package names.</p>
<p>Its last statement may return anything or nothing.</p>
</ul>


<h4><a name="require()"><code>require()</code></a></h4>

<table width="150" border="0" cellspacing="0" cellpadding="4" align="right">
<tr> 
<td width="150" valign="top" height="4" bgcolor="#6699cc"></td></tr> 
<tr>
<td bgcolor="#efefef">
<p class="headline" align="center">Previously in the Series
</p>
<p class="secondary">
<a href="http://perl.com/pub/a/2002/05/07/mod_perl.html">The Perl You Need To Know - Part 2</a><br /><br />

<a href="/pub/a/2002/04/23/mod_perl.html">The Perl You Need To Know</a><br /><br />
<a href="/pub/a/2002/04/10/mod_perl.html">Installing mod_perl without superuser privileges</a><br /><br />
<a href="/pub/a/2002/03/22/modperl.html">mod_perl in 30 minutes</a><br /><br />
<a href="/pub/a/2002/02/26/whatismodperl.html">Why mod_perl?</a>


</td></tr> <tr><td width="150" valign="top" height="4" bgcolor="#6699cc"> </td></tr></table>


<p><code>require()</code> reads a file containing Perl code and compiles it. Before
attempting to load the file, it looks up the argument in <code>%INC</code> to see
whether it has already been loaded. If it has, then <code>require()</code> just returns
without doing a thing. Otherwise, an attempt will be made to load and
compile the file.</p>
<p><code>require()</code> has to find the file it has to load. If the argument is a
full path to the file, then it just tries to read it. For example:</p>
<pre><code>
  require &quot;/home/httpd/perl/mylibs.pl&quot;;</code></pre>
<p>If the path is relative, then <code>require()</code> will attempt to search for the file
in all the directories listed in <code>@INC</code>.  For example:</p>
<pre><code>
  require &quot;mylibs.pl&quot;;</code></pre>
<p>If there is more than one occurrence of the file with the same name in
the directories listed in <code>@INC</code>, then the first occurrence will be used.</p>
<p>The file must return <em>TRUE</em> as the last statement to indicate
successful execution of any initialization code. Since you never know
what changes the file will go through in the future, you cannot be
sure that the last statement will always return <em>TRUE</em>. That's why
the suggestion is to put ``<code>1;</code>'' at the end of file.</p>
<p>Although you should use the real filename for most files, if the file
is a module, then you may use the following convention instead:</p>
<pre><code>
  require My::Module;</code></pre>
<p>This is equal to:</p>
<pre><code>
  require &quot;My/Module.pm&quot;;</code></pre>
<p>If <code>require()</code> fails to load the file, either because it couldn't find
the file in question or the code failed to compile, or it didn't
return <em>TRUE</em>, then the program would die().  To prevent this, the
<code>require()</code> statement can be enclosed into an <code>eval()</code> exception-handling
block, as in this example:</p>
<pre><code>
  require.pl
  ----------
  #!/usr/bin/perl -w
  
  eval { require &quot;/file/that/does/not/exists&quot;};
  if ($@) {
    print &quot;Failed to load, because : $@&quot;
  }
  print &quot;\nHello\n&quot;;</code></pre>
<p>When we execute the program:</p>
<pre><code>
  % ./require.pl
  
  Failed to load, because : Can't locate /file/that/does/not/exists in
  @INC (@INC contains: /usr/lib/perl5/5.00503/i386-linux
  /usr/lib/perl5/5.00503 /usr/lib/perl5/site_perl/5.005/i386-linux
  /usr/lib/perl5/site_perl/5.005 .) at require.pl line 3.
  
  Hello</code></pre>
<p>We see that the program didn't die(), because <em>Hello</em> was
printed. This <em>trick</em> is useful when you want to check whether a user
has some module installed. If she hasn't, then it's not critical,
because the program can run with reduced
functionality without this module.</p>
<p>If we remove the <code>eval()</code> part and try again:</p>
<pre><code>
  require.pl
  ----------
  #!/usr/bin/perl -w
  
  require &quot;/file/that/does/not/exists&quot;;
  print &quot;\nHello\n&quot;;</code></pre>
<pre><code>
  % ./require1.pl
  
  Can't locate /file/that/does/not/exists in @INC (@INC contains:
  /usr/lib/perl5/5.00503/i386-linux /usr/lib/perl5/5.00503
  /usr/lib/perl5/site_perl/5.005/i386-linux
  /usr/lib/perl5/site_perl/5.005 .) at require1.pl line 3.</code></pre>
<p>The program just die()s in the last example, which is what you want in
most cases.</p>
<p>For more information, refer to the perlfunc manpage.</p>


<h4><a name="use()"><code>use()</code></a></h4>
<p>use(), just like require(), loads and compiles files containing Perl
code, but it works with modules only.  The only way to pass a module
to load is by its module name and not its filename.  If the module is
located in <em>MyCode.pm</em>, then the correct way to <code>use()</code> it is:</p>
<pre><code>
  use MyCode</code></pre>
<p>and not:</p>
<pre><code>
  use &quot;MyCode.pm&quot;</code></pre>
<p><code>use()</code> translates the passed argument into a file name replacing <code>::</code>
with the operating system's path separator (normally <code>/</code>) and
appending <em>.pm</em> at the end. So <code>My::Module</code> becomes <em>My/Module.pm</em>.</p>
<p><code>use()</code> is equivalent to:</p>
<pre><code>
 BEGIN { require Module; Module-&gt;import(LIST); }</code></pre>
<p>Internally it calls <code>require()</code> to do the loading and compilation
chores. When <code>require()</code> finishes its job, <code>import()</code> is called unless
<code>()</code> is the second argument. The following pairs are equivalent:</p>
<pre><code>
  use MyModule;
  BEGIN {require MyModule; MyModule-&gt;import; }
  
  use MyModule qw(foo bar);
  BEGIN {require MyModule; MyModule-&gt;import(&quot;foo&quot;,&quot;bar&quot;); }
  
  use MyModule ();
  BEGIN {require MyModule; }</code></pre>
<p>The first pair exports the default tags. This happens if the module
sets <code>@EXPORT</code> to a list of tags to be exported by default. The
module's mainpage normally describes which tags are exported by
default.</p>
<p>The second pair exports only the tags passed as arguments.</p>
<p>The third pair describes the case where the caller does not want any
symbols to be imported.</p>
<p><code>import()</code> is not a built-in function, it's just an ordinary static
method call into the ``<code>MyModule</code>'' package to tell the module to
import the list of features back into the current package. See the
Exporter manpage for more information.</p>
<p>When you write your own modules, always remember that it's better to
use <code>@EXPORT_OK</code> instead of <code>@EXPORT</code>, since the former doesn't
export symbols unless it was asked to. Exports pollute the namespace
of the module user. Also avoid short or common symbol names to reduce
the risk of name clashes.</p>
<p>When functions and variables aren't exported you can still access them
using their full names, like <code>$My::Module::bar</code> or
<code>$My::Module::foo()</code>.  By convention you can use a leading underscore
on names to informally indicate that they are <em>internal</em> and not for
public use.</p>
<p>There's a corresponding ``<code>no</code>'' command that un-imports symbols
imported by <code>use</code>, i.e., it calls <code>Module-&gt;unimport(LIST)</code>
instead of <code>import()</code>.</p>
<p>
</p>
<h4><a name="do()"><code>do()</code></a></h4>
<p>While <code>do()</code> behaves almost identically to require(), it reloads the
file unconditionally. It doesn't check <code>%INC</code> to see whether the file
was already loaded.</p>
<p>If <code>do()</code> cannot read the file, then it returns <code>undef</code> and sets <code>$!</code> to
report the error.  If <code>do()</code> can read the file but cannot compile it, then it
returns <code>undef</code> and puts an error message in <code>$@</code>. If the file is
successfully compiled, then <code>do()</code> returns the value of the last expression
evaluated.</p>


<h3><a name="references">References</a></h3>
<ul>
<li>
An article by Mark-Jason Dominus about how Perl handles variables and
namespaces, and the difference between <code>use vars()</code> and <code>my()</code> -
<a href="http://www.plover.com/~mjd/perl/FAQs/Namespaces.html">http://www.plover.com/~mjd/perl/FAQs/Namespaces.html</a> .
</li>
<li>
For an in-depth explanation of Perl data types, see chapters 3 and 6
in the book <em>``Advanced Perl Programming''</em> by Sriram Srinivasan.
<p>And, of course, the ``<em>Programming Perl</em>'' by L.Wall, T. Christiansen and
J.Orwant (also known as the ``<em>Camel</em>'' book, named after the camel
picture on the cover of the book). Look at chapters 10, 11 and 21.</p>
</li>
<li>
The <em>Exporter</em>, <em>perlvar</em>, <em>perlmod</em> and <em>perlmodlib</em> man pages.
</li></ul>





                                    </div>


                                </div>
                                <div class="asset-footer">


                                    <div class="entry-tags">
                                        <h4>Tags<span class="delimiter">:</span></h4>
                                        <ul>
                                            <li><a href="javascript:void(0)" onclick="location.href='http://www.perl.com/mt-search.cgi?IncludeBlogs=2&amp;tag=mod_perl%20perl%20do%20require%20use%20lexical%20global&amp;limit=20';return false;" rel="tag">mod_perl perl do require use lexical global</a></li>
                                        </ul>
                                    </div>

                                </div>
                            </div>


                    
                    


                        </div>
                    </div>


                    <div id="beta">
    <div id="beta-inner">


    
    <div class="widget-what-is-perl widget">
    <div class="widget-content widget-content-what-is-perl">
       Visit the home of the  Perl programming language: <a href="http://www.perl.org/">Perl.org</a
    </div>
</div>
<div class="widget-find-out-more widget-archives widget">
    <div class="widget-content">
        <ul>
            <li><a href="http://www.perl.org/get.html">Download</a></li>
            <li><a href="http://perldoc.perl.org/">Documentation</a></li>
            <li><a href="http://blogs.perl.org/">Perl Bloggers</a></li>
            <li><a href="http://news.perlfoundation.org/">Foundation News</a></li>
        </ul>
    </div>
</div><div class="widget-tcpc widget">
<h3 class="widget-header">Sponsored by</h3>
    <div class="widget-content">
        <a href="http://training.perl.com/" alt="Perl Training" target="_blank"><img src="/i/tcpc.png" width="150" height="50"></a>
    </div>
</div>

<div class="widget-syndication widget">
    <div class="widget-content">
        <ul>
            <li><img src="/mt-static/images/status_icons/feed.gif" alt="Subscribe to feed" width="9" height="9" /> <a href="/pub/atom.xml">Subscribe to this website's feed</a></li>

        </ul>
    </div>
</div>
<div class="widget-archive-monthly widget-archive widget">
    <h3 class="widget-header">Monthly <a href="/pub/archives.html">Archives</a></h3>
    <div class="widget-content">
        <ul>
        
            <li><a href="/pub/2014/02/">February 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2014/01/">January 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/10/">October 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/01/">January 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/12/">December 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/11/">November 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/10/">October 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/08/">August 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/06/">June 2012 (11)</a></li>
        
    
        
            <li><a href="/pub/2012/05/">May 2012 (18)</a></li>
        
    
        
            <li><a href="/pub/2012/04/">April 2012 (17)</a></li>
        
    
        
            <li><a href="/pub/2012/02/">February 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/12/">December 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/09/">September 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/08/">August 2011 (2)</a></li>
        
    
        
            <li><a href="/pub/2011/06/">June 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/05/">May 2011 (3)</a></li>
        
    
        
            <li><a href="/pub/2011/04/">April 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/03/">March 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/02/">February 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/01/">January 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/11/">November 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/10/">October 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/09/">September 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/08/">August 2010 (3)</a></li>
        
    
        
            <li><a href="/pub/2010/07/">July 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/04/">April 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/03/">March 2010 (4)</a></li>
        
    
        
            <li><a href="/pub/2008/05/">May 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/04/">April 2008 (2)</a></li>
        
    
        
            <li><a href="/pub/2008/03/">March 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/02/">February 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/01/">January 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/12/">December 2007 (2)</a></li>
        
    
        
            <li><a href="/pub/2007/09/">September 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/08/">August 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/07/">July 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/06/">June 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/05/">May 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/04/">April 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/03/">March 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/02/">February 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/01/">January 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/12/">December 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/11/">November 2006 (2)</a></li>
        
    
        
            <li><a href="/pub/2006/10/">October 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/09/">September 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/08/">August 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/07/">July 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/06/">June 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/05/">May 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/04/">April 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/03/">March 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/02/">February 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2006/01/">January 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/12/">December 2005 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/11/">November 2005 (3)</a></li>
        
    
        
            <li><a href="/pub/2005/10/">October 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/09/">September 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/08/">August 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/07/">July 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/06/">June 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/05/">May 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/04/">April 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/03/">March 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2005/02/">February 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/01/">January 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/12/">December 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/11/">November 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/10/">October 2004 (5)</a></li>
        
    
        
            <li><a href="/pub/2004/09/">September 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/08/">August 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/07/">July 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/06/">June 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/05/">May 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2004/04/">April 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/03/">March 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/02/">February 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/01/">January 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/12/">December 2003 (4)</a></li>
        
    
        
            <li><a href="/pub/2003/11/">November 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/10/">October 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/09/">September 2003 (6)</a></li>
        
    
        
            <li><a href="/pub/2003/08/">August 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/07/">July 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/06/">June 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/05/">May 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/04/">April 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/03/">March 2003 (10)</a></li>
        
    
        
            <li><a href="/pub/2003/02/">February 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/01/">January 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/12/">December 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/11/">November 2002 (9)</a></li>
        
    
        
            <li><a href="/pub/2002/10/">October 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/09/">September 2002 (11)</a></li>
        
    
        
            <li><a href="/pub/2002/08/">August 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/07/">July 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/06/">June 2002 (4)</a></li>
        
    
        
            <li><a href="/pub/2002/05/">May 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/04/">April 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/03/">March 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/02/">February 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/01/">January 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/12/">December 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/11/">November 2001 (5)</a></li>
        
    
        
            <li><a href="/pub/2001/10/">October 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/09/">September 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/08/">August 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/07/">July 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/06/">June 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/05/">May 2001 (11)</a></li>
        
    
        
            <li><a href="/pub/2001/04/">April 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/03/">March 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/02/">February 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/01/">January 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2000/12/">December 2000 (6)</a></li>
        
    
        
            <li><a href="/pub/2000/11/">November 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/10/">October 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/09/">September 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/08/">August 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/07/">July 2000 (5)</a></li>
        
    
        
            <li><a href="/pub/2000/06/">June 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/05/">May 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/04/">April 2000 (3)</a></li>
        
    
        
            <li><a href="/pub/2000/03/">March 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/02/">February 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/01/">January 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/12/">December 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/11/">November 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/10/">October 1999 (5)</a></li>
        
    
        
            <li><a href="/pub/1999/09/">September 1999 (4)</a></li>
        
    
        
            <li><a href="/pub/1999/08/">August 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/07/">July 1999 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/06/">June 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/04/">April 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/03/">March 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/01/">January 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/12/">December 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/11/">November 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/07/">July 1998 (2)</a></li>
        
    
        
            <li><a href="/pub/1998/06/">June 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/03/">March 1998 (1)</a></li>
        
        </ul>
    </div>
</div>
        
    

<div class="widget-powered widget">
    <div class="widget-content">
        <a href="http://www.movabletype.com/"><img src="/mt-static/images/bug-pbmt-white.png" alt="Powered by Movable Type 5.13-en" width="120" height="75" /></a>
    </div>
</div>



    </div>
</div>






                </div>
            </div>


            <div id="footer">
    <div id="footer-inner">
        <div id="footer-content">
            <div class="widget-powered widget">
                <div class="widget-content">
                    Powered by <a href="http://www.movabletype.com/" rel="generator">Movable Type Pro</a>
                </div>
            </div>

            <div class="widget-creative-commons widget">
                <div class="widget-content">
                    This blog is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons License</a>.
                </div>
            </div>

        </div>
    </div>
</div>



        </div>
    </div>
</body>
</html>
